<!DOCTYPE html>
<html lang="en">
<html>
  <head>

 <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content=" ">
<title>Java Source Code Pretty-Printing  | Spoon</title>
<link rel="stylesheet" type="text/css" href="css/syntax.css">
<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="css/modern-business.css">
<link rel="stylesheet" type="text/css" href="css/lavish-bootstrap.css">
<link rel="canonical" href="/custom-pretty-printing.html">
<link rel="stylesheet" type="text/css" href="css/customstyles.css">
<link rel="stylesheet" type="text/css" href="css/theme-mauve.css">
<link rel="canonical" href="/custom-pretty-printing.html">
<link rel="alternate" type="application/rss+xml" title="" href="feed.xml" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->







 

  <script>
    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </head>

  <body>

   <!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Spoon</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                




                
                
                
                
                <li><a href="papers.html">Papers</a></li>
                
                
                
                
                
                <li><a href="ecosystem.html">Ecosystem</a></li>
                
                
                
                
                
                <li><a href="about.html">About</a></li>
                
                
                
                
                
                <li><a href="https://ci.inria.fr/sos/" target="_blank">Jenkins</a></li>
                
                
                
                
                
                <li><a href="https://github.com/INRIA/spoon" target="_blank">Github</a></li>
                
                
                
                


                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->

                <li class="dropdown">
                    
        </div>
        <!-- /.container -->
</nav>


    <!-- Page Content -->
    <div class="container">
      <div class="col-lg-12">&nbsp;</div>

      <!-- Content Row -->
<div class="row">
    <!-- Sidebar Column -->
    <div class="col-md-3">

        <script>

            $(document).ready(function() {
                        // Initialize navgoco with default options
                        $("#mysidebar").navgoco({
                            caretHtml: '',
                            accordion: true,
                            openClass: 'active', // open
                            save: false, // leave false or nav highlighting doesn't work right
                            cookie: {
                                name: 'navgoco',
                                expires: false,
                                path: '/'
                        },
                        slide: {
                            duration: 400,
                            easing: 'swing'
                                }
                                });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

            });

        </script>


        




        <ul id="mysidebar" class="nav">

            <div class="siteTagline">Spoon</div>

            
            
            
            <li><a href="#">Getting started</a>
                <ul>
                    
                    
                    
                    <li><a href="first_analysis_processor.html">Code Analysis</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="architecture_test.html">Architecture Checking</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="reflection.html">Runtime Reflection</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li class="active"><a href="custom-pretty-printing.html">Custom Java Pretty-Printing</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="processor.html">Processor for elements</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="/mvnsites/spoon-core/apidocs" target="_blank">Javadoc</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="spoon_javadoc.html">Javadoc Analysis</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="faq.html">FAQ</a></li>
                    

                    
            </li>
            
            
            </ul>
        </li>
        
        
            
            <li><a href="#">Querying source code elements</a>
                <ul>
                    
                    
                    
                    <li><a href="filter.html">AST Traversing</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="path.html">AST Paths and Roles</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="matcher.html">Matcher</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="pattern.html">Pattern</a></li>
                    

                    
            </li>
            
            
            </ul>
        </li>
        
        
            
            <li><a href="#">Code Transformation</a>
                <ul>
                    
                    
                    
                    <li><a href="first_transformation.html">Code Transformation</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="examples.html">Transformation Examples</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="processor_annotations.html">Transformation with annotations</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="template_definition.html">Transformation with Templates</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="spoon_smpl.html">Semantic patching</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="pattern.html#generator">Code Generation</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="testing_quickstart.html">Testing transformations</a></li>
                    

                    
            </li>
            
            
            </ul>
        </li>
        
        
            
            <li><a href="#">Usage</a>
                <ul>
                    
                    
                    
                    <li><a href="launcher.html">From Java</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="command_line.html">Command Line</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="maven.html">From Maven Plugin</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="gradle.html">From Gradle Plugin</a></li>
                    

                    
            </li>
            
            
            </ul>
        </li>
        
        
            
            <li><a href="#">Spoon Meta model</a>
                <ul>
                    
                    
                    
                    <li><a href="structural_elements.html">Structural elements</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="code_elements.html">Code elements</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="references.html">References</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="factories.html">Create elements with factories</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="comments.html">Comments and Positions</a></li>
                    

                    
            </li>
            
            
            </ul>
        </li>
        
        
        
        </ul>

        
    </div>
       <!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above.-->
    <script>$("li.active").parents('li').toggleClass("active");</script>


      <!-- Content Column -->
      <div class="col-md-9">

          <div class="post-header">
   <h1 class="post-title-main">Java Source Code Pretty-Printing</h1>
</div>

<div class="post-content">

   

  <p>Spoon provides users with different options to pretty-print the Java code.</p>

<h2 id="fully-qualified-pretty-printing">Fully-qualified Pretty-Printing</h2>

<p>Spoon can pretty-print code where all classes and methods are fully-qualified. This is the default behavior on <code class="language-plaintext highlighter-rouge">toString()</code> on AST elements.
This is not readable for humans but is useful when name collisions happen. If <code class="language-plaintext highlighter-rouge">launcher.getEnvironment().getToStringMode() == FULLYQUALIFIED</code>, the files written on disk are also fully qualified.</p>

<h2 id="autoimport-pretty-printing">Autoimport Pretty-Printing</h2>

<p>Spoon can pretty-print code where all classes and methods are imported as long as no conflict exists.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">launcher</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">().</span><span class="na">setAutoImports</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</code></pre></div></div>

<p>The autoimport mode computes the required imports, add the imports in the pretty-printed files, and writes class names unqualified (w/o package names). This involves changing the field <code class="language-plaintext highlighter-rouge">implicit</code> of some elements of the model, through a set of <code class="language-plaintext highlighter-rouge">ImportAnalyzer</code>, most notable <code class="language-plaintext highlighter-rouge">ImportCleaner</code> and <code class="language-plaintext highlighter-rouge">ImportConflictDetector</code>.
When pretty-printing, Spoon reformats the code according to its own formatting rules that can be configured by providing a custom <code class="language-plaintext highlighter-rouge">TokenWriter</code>.</p>

<h2 id="sniper-pretty-printing-mode">Sniper Pretty-Printing Mode</h2>

<p>The sniper mode enables to rewrite only the transformed AST elements, so that the rest of the code is printed identically to the origin version. This is useful to get small diffs after automated refactoring.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">launcher</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">().</span><span class="na">setPrettyPrinterCreator</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
   <span class="k">return</span> <span class="k">new</span> <span class="nf">SniperJavaPrettyPrinter</span><span class="o">(</span><span class="n">launcher</span><span class="o">.</span><span class="na">getEnvironment</span><span class="o">());</span>
  <span class="o">}</span>
<span class="o">);</span>
</code></pre></div></div>

<h2 id="user-defined-pretty-printing-mode">User-Defined Pretty-Printing Mode</h2>

<p>It is a good practice to have consistent formatting in a project.
Spoon can be used to implement a custom Java pretty-printer, according to the guidelines of your project.
For instance, this can be used to write a pretty-printer according to a custom Checkstyle ruleset.</p>

<p>The idea is to configure <code class="language-plaintext highlighter-rouge">DefaultJavaPrettyPrinter</code> with an appropriate <code class="language-plaintext highlighter-rouge">TokenWriter</code>. Subclasses of <a href="http://spoon.gforge.inria.fr/mvnsites/spoon-core/apidocs/spoon/reflect/visitor/TokenWriter.html"><code class="language-plaintext highlighter-rouge">TokenWriter</code></a> can override a number of pretty-printing methods.</p>

<p>For instance, here is an example of a pretty-printer that writes two spaces before each keyword (see source in <a href="https://github.com/INRIA/spoon/blob/master/src/test/java/spoon/test/prettyprinter/PrinterTest.java"><code class="language-plaintext highlighter-rouge">testCustomPrettyPrinter</code></a>):</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nc">Launcher</span> <span class="n">spoon</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Launcher</span><span class="o">();</span>
<span class="c1">// Java file to be pretty-printed, can be a folder as well</span>
<span class="n">spoon</span><span class="o">.</span><span class="na">addInputResource</span><span class="o">(</span><span class="s">"src/test/resources/JavaCode.java"</span><span class="o">);</span>
<span class="n">spoon</span><span class="o">.</span><span class="na">getFactory</span><span class="o">().</span><span class="na">getEnvironment</span><span class="o">().</span><span class="na">setPrettyPrinterCreator</span><span class="o">(()</span> <span class="o">-&gt;</span> <span class="o">{</span>
    <span class="nc">DefaultJavaPrettyPrinter</span> <span class="n">defaultJavaPrettyPrinter</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">DefaultJavaPrettyPrinter</span><span class="o">(</span><span class="n">spoon</span><span class="o">.</span><span class="na">getFactory</span><span class="o">().</span><span class="na">getEnvironment</span><span class="o">());</span>
    <span class="c1">// here we create the custom version of the token writer</span>
    <span class="n">defaultJavaPrettyPrinter</span><span class="o">.</span><span class="na">setPrinterTokenWriter</span><span class="o">(</span><span class="k">new</span> <span class="nc">DefaultTokenWriter</span><span class="o">()</span> <span class="o">{</span>
      <span class="nd">@Override</span>
      <span class="kd">public</span> <span class="nc">DefaultTokenWriter</span> <span class="nf">writeKeyword</span><span class="o">(</span><span class="nc">String</span> <span class="n">token</span><span class="o">)</span> <span class="o">{</span>
        <span class="c1">// write two spaces and then the keyword</span>
        <span class="n">getPrinterHelper</span><span class="o">().</span><span class="na">write</span><span class="o">(</span><span class="s">"   "</span> <span class="o">+</span> <span class="n">token</span><span class="o">);</span>
        <span class="k">return</span> <span class="k">this</span><span class="o">;</span>
      <span class="o">}</span>
    <span class="o">});</span>
    <span class="k">return</span> <span class="n">defaultJavaPrettyPrinter</span><span class="o">;</span>
<span class="o">});</span>
<span class="n">spoon</span><span class="o">.</span><span class="na">run</span><span class="o">();</span>
</code></pre></div></div>

<p>That’s it! The pretty-printed code is in folder ./spooned (default value that can be set with setOutputDirectory).</p>






















































































































































</div>

<hr class="shaded"/> 

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               	<a href="https://github.com/INRIA/spoon/issues/new">Contact / Feedback / Question / Bug Report</a><br />
                </div>
            </div>
        </footer>

      </div><!-- /.row -->

    </div>    <!-- /.container -->

  </body>

  
  <!-- the google_analytics_id gets auto inserted from the config file -->


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-24273081-1', 'auto');
    ga('send', 'pageview');
</script>

  

</html>

