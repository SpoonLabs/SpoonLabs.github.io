<!DOCTYPE html>
<html lang="en">
<html>
  <head>

 <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="keywords" content="getting-started,  ">
<title>Using Spoon for Architecture Enforcement  | Spoon</title>
<link rel="stylesheet" type="text/css" href="css/syntax.css">
<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css">
<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">
<link rel="stylesheet" type="text/css" href="css/modern-business.css">
<link rel="stylesheet" type="text/css" href="css/lavish-bootstrap.css">
<link rel="canonical" href="/architecture_test.html">
<link rel="stylesheet" type="text/css" href="css/customstyles.css">
<link rel="stylesheet" type="text/css" href="css/theme-mauve.css">
<link rel="canonical" href="/architecture_test.html">
<link rel="alternate" type="application/rss+xml" title="" href="feed.xml" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->







 

  <script>
    $(function () {
        $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </head>

  <body>

   <!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Spoon</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- entries without drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->
                




                
                
                
                
                <li><a href="papers.html">Papers</a></li>
                
                
                
                
                
                <li><a href="ecosystem.html">Ecosystem</a></li>
                
                
                
                
                
                <li><a href="about.html">About</a></li>
                
                
                
                
                
                <li><a href="https://ci.inria.fr/sos/" target="_blank">Jenkins</a></li>
                
                
                
                
                
                <li><a href="https://github.com/INRIA/spoon" target="_blank">Github</a></li>
                
                
                
                


                <!-- entries with drop-downs appear here -->
                <!-- conditional logic to control which topnav appears for the audience defined in the configuration file.-->

                <li class="dropdown">
                    
        </div>
        <!-- /.container -->
</nav>


    <!-- Page Content -->
    <div class="container">
      <div class="col-lg-12">&nbsp;</div>

      <!-- Content Row -->
<div class="row">
    <!-- Sidebar Column -->
    <div class="col-md-3">

        <script>

            $(document).ready(function() {
                        // Initialize navgoco with default options
                        $("#mysidebar").navgoco({
                            caretHtml: '',
                            accordion: true,
                            openClass: 'active', // open
                            save: false, // leave false or nav highlighting doesn't work right
                            cookie: {
                                name: 'navgoco',
                                expires: false,
                                path: '/'
                        },
                        slide: {
                            duration: 400,
                            easing: 'swing'
                                }
                                });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

            });

        </script>


        




        <ul id="mysidebar" class="nav">

            <div class="siteTagline">Spoon</div>

            
            
            
            <li><a href="#">Getting started</a>
                <ul>
                    
                    
                    
                    <li><a href="first_analysis_processor.html">Code Analysis</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li class="active"><a href="architecture_test.html">Architecture Checking</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="reflection.html">Runtime Reflection</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="custom-pretty-printing.html">Custom Java Pretty-Printing</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="processor.html">Processor for elements</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="/mvnsites/spoon-core/apidocs" target="_blank">Javadoc</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="faq.html">FAQ</a></li>
                    

                    
            </li>
            
            
            </ul>
        </li>
        
        
            
            <li><a href="#">Querying source code elements</a>
                <ul>
                    
                    
                    
                    <li><a href="filter.html">AST Traversing</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="path.html">AST Paths and Roles</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="matcher.html">Matcher</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="pattern.html">Pattern</a></li>
                    

                    
            </li>
            
            
            </ul>
        </li>
        
        
            
            <li><a href="#">Code Transformation</a>
                <ul>
                    
                    
                    
                    <li><a href="first_transformation.html">Code Transformation</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="examples.html">Transformation Examples</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="processor_annotations.html">Transformation with annotations</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="template_definition.html">Transformation with Templates</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="spoon_smpl.html">Semantic patching</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="pattern.html#generator">Code Generation</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="testing_quickstart.html">Testing transformations</a></li>
                    

                    
            </li>
            
            
            </ul>
        </li>
        
        
            
            <li><a href="#">Usage</a>
                <ul>
                    
                    
                    
                    <li><a href="launcher.html">From Java</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="command_line.html">Command Line</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="maven.html">From Maven Plugin</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="gradle.html">From Gradle Plugin</a></li>
                    

                    
            </li>
            
            
            </ul>
        </li>
        
        
            
            <li><a href="#">Spoon Meta model</a>
                <ul>
                    
                    
                    
                    <li><a href="structural_elements.html">Structural elements</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="code_elements.html">Code elements</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="references.html">References</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="factories.html">Create elements with factories</a></li>
                    

                    
            </li>
            
            
                    
                    
                    <li><a href="comments.html">Comments and Positions</a></li>
                    

                    
            </li>
            
            
            </ul>
        </li>
        
        
        
        </ul>

        
    </div>
       <!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above.-->
    <script>$("li.active").parents('li').toggleClass("active");</script>


      <!-- Content Column -->
      <div class="col-md-9">

          <div class="post-header">
   <h1 class="post-title-main">Using Spoon for Architecture Enforcement</h1>
</div>

<div class="post-content">

   

  <p>In software, an architectural rule (aka architectural constraint) specifies a design decision on the application. Architectural rules cannot usually be expressed in the programming language itself.
Architectural rules can be written as AST analysis, which makes Spoon very appropriate to express and check them.
Since architectural rules must be automatically checked as often as possible, it’s good to have them part of continuous integration.</p>

<p>To write an architectural rule in Spoon that is checked in CI, the idea is to write a standard Junit test case that loads the application code, express the rule and check it. Doing this only requires to depend on Spoon at testing time, ie <code class="language-plaintext highlighter-rouge">&lt;scope&gt;test&lt;/scope&gt;</code> in Maven.</p>

<h3 id="example-rule-never-use-the-treeset-constructor">Example rule: never use the TreeSet constructor</h3>

<p>For instance, let’s imagine that you want to forbid the usage of <code class="language-plaintext highlighter-rouge">TreeSet</code>’s constructor, in your code base, you would simply write a test case as follows:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kt">void</span> <span class="nf">noTreeSet</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
	<span class="nc">SpoonAPI</span> <span class="n">spoon</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Launcher</span><span class="o">();</span>
	<span class="n">spoon</span><span class="o">.</span><span class="na">addInputResource</span><span class="o">(</span><span class="s">"src/main/java/"</span><span class="o">);</span>
	<span class="n">spoon</span><span class="o">.</span><span class="na">buildModel</span><span class="o">();</span>
	
	<span class="n">assertEquals</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span> <span class="n">spoon</span><span class="o">.</span><span class="na">getFactory</span><span class="o">().</span><span class="na">Package</span><span class="o">().</span><span class="na">getRootPackage</span><span class="o">().</span><span class="na">getElements</span><span class="o">(</span><span class="k">new</span> <span class="nc">AbstractFilter</span><span class="o">&lt;</span><span class="nc">CtConstructorCall</span><span class="o">&gt;()</span> <span class="o">{</span>
		<span class="nd">@Override</span>
		<span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">matches</span><span class="o">(</span><span class="nc">CtConstructorCall</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
			<span class="k">return</span> <span class="n">element</span><span class="o">.</span><span class="na">getType</span><span class="o">().</span><span class="na">getActualClass</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="nc">TreeSet</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
		<span class="o">};</span>
	<span class="o">}).</span><span class="na">size</span><span class="o">());</span>
<span class="o">}</span>
</code></pre></div></div>

<p>That’s it! Every time you run the tests, incl. on your continuous integration server, the architectural rules are enforced.</p>

<p>For instance, you can check that you never return null, or always use an appropriate factory, or that all classes implementing an interface are in the same package.</p>

<h3 id="example-rule-all-test-classes-must-start-or-end-with-test">Example rule: all test classes must start or end with “Test”</h3>

<p>A common mistake is to forget to follow a naming convention. For instance, if you use Maven, all test classes must be named <code class="language-plaintext highlighter-rouge">Test*</code> or <code class="language-plaintext highlighter-rouge">*Test</code> in order to be run by Maven’s standard test plugin <code class="language-plaintext highlighter-rouge">surefire</code> (<a href="http://maven.apache.org/surefire/maven-surefire-plugin/examples/inclusion-exclusion.html">see doc</a>). This rule simply reads:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGoodTestClassNames</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">SpoonAPI</span> <span class="n">spoon</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Launcher</span><span class="o">();</span>
    <span class="n">spoon</span><span class="o">.</span><span class="na">addInputResource</span><span class="o">(</span><span class="s">"src/test/java/"</span><span class="o">);</span>
    <span class="n">spoon</span><span class="o">.</span><span class="na">buildModel</span><span class="o">();</span>

    <span class="k">for</span> <span class="o">(</span><span class="nc">CtMethod</span><span class="o">&lt;?&gt;</span> <span class="n">meth</span> <span class="o">:</span> <span class="n">spoon</span><span class="o">.</span><span class="na">getModel</span><span class="o">().</span><span class="na">getRootPackage</span><span class="o">().</span><span class="na">getElements</span><span class="o">(</span><span class="k">new</span> <span class="nc">TypeFilter</span><span class="o">&lt;</span><span class="nc">CtMethod</span><span class="o">&gt;(</span><span class="nc">CtMethod</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
            <span class="nd">@Override</span>
            <span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">matches</span><span class="o">(</span><span class="nc">CtMethod</span> <span class="n">element</span><span class="o">)</span> <span class="o">{</span>
                    <span class="k">return</span> <span class="kd">super</span><span class="o">.</span><span class="na">matches</span><span class="o">(</span><span class="n">element</span><span class="o">)</span> <span class="o">&amp;&amp;</span> <span class="n">element</span><span class="o">.</span><span class="na">getAnnotation</span><span class="o">(</span><span class="nc">Test</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">;</span>
            <span class="o">}</span>
    <span class="o">}))</span> <span class="o">{</span>
            <span class="n">assertTrue</span><span class="o">(</span><span class="s">"naming contract violated for "</span><span class="o">+</span><span class="n">meth</span><span class="o">.</span><span class="na">getParent</span><span class="o">(</span><span class="nc">CtClass</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getSimpleName</span><span class="o">(),</span> <span class="n">meth</span><span class="o">.</span><span class="na">getParent</span><span class="o">(</span><span class="nc">CtClass</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getSimpleName</span><span class="o">().</span><span class="na">startsWith</span><span class="o">(</span><span class="s">"Test"</span><span class="o">)</span> <span class="o">||</span> <span class="n">meth</span><span class="o">.</span><span class="na">getParent</span><span class="o">(</span><span class="nc">CtClass</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getSimpleName</span><span class="o">().</span><span class="na">endsWith</span><span class="o">(</span><span class="s">"Test"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>

<h3 id="example-rule-all-public-methods-must-be-documented">Example rule: all public methods must be documented</h3>

<p>How to check that all public methods of the API contain proper Javadoc? One can also use Spoon to check documentation rules like this one.</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nd">@Test</span>
<span class="kd">public</span> <span class="kt">void</span> <span class="nf">testDocumentation</span><span class="o">()</span> <span class="kd">throws</span> <span class="nc">Exception</span> <span class="o">{</span>
    <span class="nc">SpoonAPI</span> <span class="n">spoon</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Launcher</span><span class="o">();</span>
    <span class="n">spoon</span><span class="o">.</span><span class="na">addInputResource</span><span class="o">(</span><span class="s">"src/main/java/"</span><span class="o">);</span>
    <span class="n">spoon</span><span class="o">.</span><span class="na">buildModel</span><span class="o">();</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">String</span><span class="o">&gt;</span> <span class="n">notDocumented</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">ArrayList</span><span class="o">&lt;&gt;();</span>
    <span class="k">for</span> <span class="o">(</span><span class="nc">CtMethod</span> <span class="n">method</span> <span class="o">:</span> <span class="n">spoon</span><span class="o">.</span><span class="na">getModel</span><span class="o">().</span><span class="na">getElements</span><span class="o">(</span><span class="k">new</span> <span class="nc">TypeFilter</span><span class="o">&lt;&gt;(</span><span class="nc">CtMethod</span><span class="o">.</span><span class="na">class</span><span class="o">)))</span> <span class="o">{</span>
            <span class="c1">// now we see whether this should be documented</span>
            <span class="k">if</span> <span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">hasModifier</span><span class="o">(</span><span class="nc">ModifierKind</span><span class="o">.</span><span class="na">PUBLIC</span><span class="o">)</span>
                <span class="o">&amp;&amp;</span> <span class="n">method</span><span class="o">.</span><span class="na">getTopDefinitions</span><span class="o">().</span><span class="na">size</span><span class="o">()</span> <span class="o">==</span> <span class="mi">0</span> <span class="c1">// optional: only the top declarations should be documented (not the overriding methods which are lower in the hierarchy)</span>
            <span class="o">))</span> <span class="o">{</span>
                    <span class="c1">// is it really well documented?</span>
                    <span class="k">if</span> <span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">getDocComment</span><span class="o">().</span><span class="na">length</span><span class="o">()</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// at least 20 characters</span>
                            <span class="n">notDocumented</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">getParent</span><span class="o">(</span><span class="nc">CtType</span><span class="o">.</span><span class="na">class</span><span class="o">).</span><span class="na">getQualifiedName</span><span class="o">()</span> <span class="o">+</span> <span class="s">"#"</span> <span class="o">+</span> <span class="n">method</span><span class="o">.</span><span class="na">getSignature</span><span class="o">());</span>
                    <span class="o">}</span>
            <span class="o">}</span>
    <span class="o">}</span>
    <span class="k">if</span> <span class="o">(</span><span class="n">notDocumented</span><span class="o">.</span><span class="na">size</span><span class="o">()</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">fail</span><span class="o">(</span><span class="n">notDocumented</span><span class="o">.</span><span class="na">size</span><span class="o">()+</span><span class="s">" public methods should be documented with proper API documentation: \n"</span><span class="o">+</span><span class="nc">StringUtils</span><span class="o">.</span><span class="na">join</span><span class="o">(</span><span class="n">notDocumented</span><span class="o">,</span> <span class="s">"\n"</span><span class="o">));</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div>
<h3 id="example-rule-all-private-fields-mustnt-be-unused">Example rule: all private fields mustn’t be unused.</h3>
<p>How to check that all private fields are used?
We define used here as every field has a read. We can skip the check for writes, because a read to a field will never happen without a write.
In 8 simple steps we can check this. You can easily extend this for public fields, but sometime public fields together expose an API and have no read.
Or you extend the check for writes. This could find fields reading a field before a write.</p>
<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1">// Step 1: create model</span>
    <span class="nc">SpoonAPI</span> <span class="n">spoon</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Launcher</span><span class="o">();</span>
    <span class="n">spoon</span><span class="o">.</span><span class="na">addInputResource</span><span class="o">(</span><span class="s">"src/main/java/"</span><span class="o">);</span>
    <span class="nc">CtModel</span> <span class="n">model</span> <span class="o">=</span> <span class="n">spoon</span><span class="o">.</span><span class="na">buildModel</span><span class="o">();</span>
    <span class="c1">// Step2: Query the model for all fields</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">CtField</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">fields</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">getElements</span><span class="o">(</span><span class="k">new</span> <span class="nc">TypeFilter</span><span class="o">&lt;&gt;(</span><span class="nc">CtField</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
    <span class="c1">// Step 3: Remove fields not matching conditions. Our conditions here are:</span>
    <span class="c1">// 1. Only private fields</span>
    <span class="c1">// 2. No serialization fields  </span>
    <span class="c1">// Filter non private fields</span>
    <span class="n">fields</span><span class="o">.</span><span class="na">removeIf</span><span class="o">(</span><span class="n">v</span> <span class="o">-&gt;</span> <span class="o">!</span><span class="n">v</span><span class="o">.</span><span class="na">isPrivate</span><span class="o">());</span>
    <span class="c1">// remove fields for serialization gods</span>
    <span class="n">fields</span><span class="o">.</span><span class="na">removeIf</span><span class="o">(</span><span class="n">v</span> <span class="o">-&gt;</span> <span class="n">v</span><span class="o">.</span><span class="na">getSimpleName</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">"serialVersionUID"</span><span class="o">));</span>
    <span class="c1">// Step 4: Query the model for all fieldReads</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">CtFieldRead</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">fieldRead</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="na">getElements</span><span class="o">(</span><span class="k">new</span> <span class="nc">TypeFilter</span><span class="o">&lt;&gt;(</span><span class="nc">CtFieldRead</span><span class="o">.</span><span class="na">class</span><span class="o">));</span>
    <span class="c1">// some fieldReads have no variable declaration</span>
    <span class="n">fieldRead</span><span class="o">.</span><span class="na">removeIf</span><span class="o">(</span><span class="n">v</span> <span class="o">-&gt;</span> <span class="n">v</span><span class="o">.</span><span class="na">getVariable</span><span class="o">().</span><span class="na">getFieldDeclaration</span><span class="o">()</span> <span class="o">==</span> <span class="kc">null</span><span class="o">);</span>
    <span class="c1">// convert to HashSet for faster lookup. We trade memory for lookup speed.</span>
    <span class="c1">// Step 5: Query every fieldRead for there declaring field </span>
    <span class="nc">HashSet</span><span class="o">&lt;</span><span class="nc">CtField</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">lookUp</span> <span class="o">=</span> <span class="n">fieldRead</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
    		<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="nl">CtFieldRead:</span><span class="o">:</span><span class="n">getVariable</span><span class="o">)</span>
    		<span class="o">.</span><span class="na">map</span><span class="o">(</span><span class="n">v</span> <span class="o">-&gt;</span> <span class="n">v</span><span class="o">.</span><span class="na">getFieldDeclaration</span><span class="o">())</span>
                    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toCollection</span><span class="o">(</span><span class="nl">HashSet:</span><span class="o">:</span><span class="k">new</span><span class="o">));</span>
    <span class="c1">// Step 6: Lookup every field in the set. The set contains all fields, that have a read.</span>
    <span class="nc">List</span><span class="o">&lt;</span><span class="nc">CtField</span><span class="o">&lt;?&gt;&gt;</span> <span class="n">fieldsWithRead</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="na">stream</span><span class="o">()</span>
    		<span class="c1">// 	 every field must have a read</span>
    		<span class="o">.</span><span class="na">filter</span><span class="o">(</span><span class="n">field</span> <span class="o">-&gt;</span> <span class="n">lookUp</span><span class="o">.</span><span class="na">contains</span><span class="o">(</span><span class="n">field</span><span class="o">))</span>
    <span class="o">.</span><span class="na">collect</span><span class="o">(</span><span class="nc">Collectors</span><span class="o">.</span><span class="na">toList</span><span class="o">());</span>
    <span class="c1">// Step 7: Remove the fields having a read from the set of fields. </span>
    <span class="n">fields</span><span class="o">.</span><span class="na">removeAll</span><span class="o">(</span><span class="n">fieldsWithRead</span><span class="o">);</span>
    <span class="c1">// Step 8: Lets compare our result. if the set is empty, every field has a read, otherwise print the fields without read. </span>
    <span class="n">assertEquals</span><span class="o">(</span><span class="s">"Some Fields have no read/write"</span><span class="o">,</span> <span class="nc">Collections</span><span class="o">.</span><span class="na">emptyList</span><span class="o">(),</span> <span class="n">fields</span><span class="o">);</span>
</code></pre></div></div>
<h3 id="related-work-in-architecture-enforcement">Related work in architecture enforcement</h3>

<ul>
  <li><a href="https://saturnnetwork.wordpress.com/2012/11/26/ultimate-architecture-enforcement-prevent-code-violations-at-code-commit-time/">Architecture enforcement with Checkstyle</a></li>
  <li><a href="https://docs.sonarqube.org/display/SONARQUBE44/Architecture+Rule+Engine">Sonar architecture rule engine</a></li>
  <li><a href="https://www.archunit.org/">Archunit:  specify and assert architecture rules in plain Java</a> (<a href="https://github.com/societe-generale/arch-unit-maven-plugin">Maven integration</a>)</li>
  <li><a href="https://jqassistant.org/">jqassistant</a> does architectural checking on top of Neo4J.</li>
</ul>






















































































































































</div>

<hr class="shaded"/> 

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               	<a href="https://github.com/INRIA/spoon/issues/new">Contact / Feedback / Question / Bug Report</a><br />
                Site last generated: May 23, 2021 <br />
                </div>
            </div>
        </footer>

      </div><!-- /.row -->

    </div>    <!-- /.container -->

  </body>

  
  <!-- the google_analytics_id gets auto inserted from the config file -->


<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-24273081-1', 'auto');
    ga('send', 'pageview');
</script>

  

</html>

